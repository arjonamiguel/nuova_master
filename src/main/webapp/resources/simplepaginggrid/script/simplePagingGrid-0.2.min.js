(function(a){function b(a,b,c){return a.slice(b*c,b*c+c)}a.fn.simplePagingGrid=function(c){var d=a.extend({buttonBarTemplate:'<div><button class="btn pull-left">« Prev</button><button class="btn pull-right">Next &raquo</button><div class="page-numbers"></div><div class="clearfix"></div>',tableTemplate:"<table><thead></thead><tbody></tbody></table>",headerTemplate:'<th width="{{width}}">{{title}}</th>',sortableHeaderTemplate:'<th width="{{width}}"><ul class="sort"><li class="sort-ascending"/><li class="sort-descending"/></ul>{{title}}</th>',emptyCellTemplate:"<td> </td>",loadingOverlayTemplate:'<div class="loading"></div>',currentPageTemplate:'<span class="page-number">{{pageNumber}}</span>',pageLinkTemplate:'<a class="page-number" href="#">{{pageNumber}}</a>'},c.templates);var e=a.extend({pageSize:10,columnWidths:[],cellTemplates:null,headerTemplates:null,sortable:[],sortOrder:"asc",initialSortColumn:null,tableClass:"table",dataFunction:null,dataUrl:null,data:null,minimumVisibleRows:10,showLoadingOverlay:true,showPageNumbers:true,numberOfPageLinks:20},c);e.templates=d;return this.each(function(){function v(){return Math.ceil(n/e.pageSize)}function w(){if(o){k.attr("disabled","disabled");l.attr("disabled","disabled")}else{if(i===0){k.attr("disabled","disabled")}else{k.removeAttr("disabled")}if(n===null&&m.length<e.pageSize||n!==null&&i>=v()-1){l.attr("disabled","disabled")}else{l.removeAttr("disabled")}}}function x(){function b(a){return function(b){b.preventDefault();i=a-1;C()}}if(e.showPageNumbers&&n!==null){var c;var d;var f=v();var g=[];var h;var k;c=i+1-e.numberOfPageLinks/2;if(c<1){c=1;d=e.numberOfPageLinks;if(d>f){d=f}}else{d=i+1+e.numberOfPageLinks/2-1;if(d>f){d=f;c=d-e.numberOfPageLinks+1;if(c<1)c=1}}var l=j.find(".page-numbers");l.empty();for(h=c;h<=d;h++){if(h===i+1){k=a(Mustache.render(e.templates.currentPageTemplate,{pageNumber:h}))}else{k=a(Mustache.render(e.templates.pageLinkTemplate,{pageNumber:h}));k.click(b(h))}l.append(k)}}}function y(){if(s!=null){s.width(u.width());s.height(u.height())}}function z(){if(e.showLoadingOverlay){s=a(e.templates.loadingOverlayTemplate);y();u.prepend(s)}}function A(){if(s!==null){s.remove();s=null}}function B(b){if(a.isArray(b)){m=b}else if(a.isPlainObject(b)){m=b.currentPage;n=b.totalRows}}function C(c){var d;var f;var g;var h;if(c!==undefined){e.dataUrl=c;i=0}if(e.data!==null){if(a.isArray(e.data)){h=e.data}else if(a.isPlainObject(e.data)){h=e.data.currentPage;n=e.data.totalRows}d=q===null?h:h.sort(function(b,c){f=p==="asc"?b[q]:c[q];g=p==="asc"?c[q]:b[q];if(a.isNumeric(f)){if(f<g){return 1}else if(f>g){return-1}return 0}return f.localeCompare(g)});m=b(d,i,e.pageSize);t.currentData=m;D();w();x()}else if(e.dataUrl!==null){o=true;w();z();a.getJSON(e.dataUrl,{page:i,pageSize:e.pageSize,sortColumn:q,sortOrder:p},function(a){B(a);t.currentData=m;D();o=false;w();x();A()})}else if(e.dataFunction!==null){B(e.dataFunction(i,e.pageSize,q,p));t.currentData=m;D();w();x()}}function D(){d.empty();a.each(m,function(b,c){var f=a("<tr>");a.each(e.columnKeys,function(b,d){var g=a("<td>");if(e.cellTemplates!==null&&b<e.cellTemplates.length&&e.cellTemplates[b]!==null){g.html(Mustache.render(e.cellTemplates[b],c))}else{g.html(c[d])}f.append(g)});d.append(f)});if(m.length<e.minimumVisibleRows){var b;var c;for(b=m.length;b<e.minimumVisibleRows;b++){c=a("<tr>");a.each(e.columnKeys,function(){c.append(Mustache.render(e.templates.emptyCellTemplate))});d.append(c)}}}var c;var d;var f;var g;var h;var i=0;var j;var k;var l;var m;var n=null;var o=false;var p=e.sortOrder;var q=e.initialSortColumn;var r=null;var s=null;var t=this;var u=a(this);c=a(e.templates.tableTemplate);f=c.find("thead");g=a("<tr>").appendTo(f);d=c.find("tbody");a.each(e.columnNames,function(b,c){var d=e.sortable[b];var f;var h;var i=e.columnKeys[b];var j;var k=null;j=e.columnWidths.length>b?e.columnWidths[b]:"";if(e.headerTemplates!==null&&b<e.headerTemplates.length&&e.headerTemplates[b]!=null){k=a(Mustache.render(e.headerTemplates[b],{width:j,title:c}))}if(d){if(k===null){k=a(Mustache.render(e.templates.sortableHeaderTemplate,{width:j,title:c}))}f=k.find(".sort-ascending");h=k.find(".sort-descending");function l(a){a.preventDefault();if(q===i){p=p==="asc"?"desc":"asc"}q=i;if(r!=null){r.removeClass("sort-ascending-active");r.removeClass("sort-descending-active")}r=p==="asc"?f:h;r.addClass(p==="asc"?"sort-ascending-active":"sort-descending-active");C()}f.click(function(a){l(a)});h.click(function(a){l(a)})}else{if(k===null){k=a(Mustache.render(e.templates.headerTemplate,{width:j,title:c}))}}g.append(k)});c.addClass(e.tableClass);buttonBarHtml=e.templates.buttonBarTemplate;j=a(buttonBarHtml);k=j.find("button").first();l=j.find("button").last();k.click(function(a){a.preventDefault();if(i>0){i--;C()}});l.click(function(a){a.preventDefault();if(m.length===e.pageSize){i++;C()}});C();u.append(c);u.append(j);a(window).resize(y);t.refreshData=C;return this})}})(jQuery)